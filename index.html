<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 6.4.1" />
    <title>heatrapy API documentation</title>
    <link rel="icon" href="https://github.com/djsilva99/heatrapy/blob/master/img/heatrapy.png?raw=true">


<style type="text/css">/*! * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/) * Copyright 2011-2020 The Bootstrap Authors * Copyright 2011-2020 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style type="text/css">/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style type="text/css">/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main{padding:2rem 3vw;}.git-button{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{display:none;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3, .pdoc h4{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox">
            <div>


                    <h2><img src="https://github.com/djsilva99/heatrapy/blob/master/img/heatrapy.png?raw=true" alt="Drawing" height="30"/> heatrapy</h2>
                    <ul>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#thermal-object">Thermal object</a></li>
  <li><a href="#database-of-materials">Database of materials</a></li>
  <li><a href="#visualization">Visualization</a></li>
  <li><a href="#example">Example</a></li>
  <li><a href="#changelog">Changelog</a></li>
  <li><a href="#license">License</a></li>
  <li><a href="#contributing">Contributing</a></li>
  <li><a href="#citing-heatrapy">Citing Heatrapy</a></li>
</ul>



                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="class" href="#SystemObjects1D">SystemObjects1D</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SystemObjects1D.__init__">SystemObjects1D</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects1D.contact_filter">contact_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects1D.contact_add">contact_add</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects1D.contact_remove">contact_remove</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects1D.change_boundaries">change_boundaries</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects1D.compute">compute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SingleObject1D">SingleObject1D</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SingleObject1D.__init__">SingleObject1D</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.show_figure">show_figure</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.activate">activate</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.deactivate">deactivate</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.change_power">change_power</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.change_boundaries">change_boundaries</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject1D.compute">compute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SystemObjects2D">SystemObjects2D</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SystemObjects2D.__init__">SystemObjects2D</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects2D.contact_filter">contact_filter</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects2D.contact_add">contact_add</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects2D.contact_remove">contact_remove</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects2D.change_boundaries">change_boundaries</a>
                        </li>
                        <li>
                                <a class="function" href="#SystemObjects2D.compute">compute</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SingleObject2D">SingleObject2D</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SingleObject2D.__init__">SingleObject2D</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.show_figure">show_figure</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.activate">activate</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.deactivate">deactivate</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.change_boundaries">change_boundaries</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.change_material">change_material</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.change_power">change_power</a>
                        </li>
                        <li>
                                <a class="function" href="#SingleObject2D.compute">compute</a>
                        </li>
                </ul>

            </li>
    </ul>


                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
heatrapy    </h1>

                        <div class="docstring"><p>Heatrapy stands for HEAt TRAnsfer in PYthon. It simulates dynamic 1D and 2D heat transfer processes in solids using the finite difference method. Heatrapy includes both the modeling of caloric effects and the incorporation of phase transitions.</p>

<p>author: Daniel Silva (djsilva@gmx.com) <br> current version: v2.0.1</p>

<h2 id="installation">Installation</h2>

<p>To install heatrapy use the pip package manager:</p>

<div class="codehilite"><pre><span></span><code>$ pip install heatrapy
</code></pre></div>

<p>To import the heatrapy module type in the python shell:</p>

<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">heatrapy</span> <span class="k">as</span> <span class="nn">htp</span>
</code></pre></div>

<h2 id="thermal-object">Thermal object</h2>

<p>Thermal objects are the building block of the heatrapy module. Each thermal object is defined by a range of discrete space, where each point incorporates thermal properties, power sources and temperature. Boundary conditions are also defined and can be changed at any time. Thermal objects can use several methods that change the sate of each point, materials properties, and power sources. The state of each point defines if a field is applied (if True) or not (if False). This is of paramount importance for caloric materials. Moreover, phase change transitions can be incorporated according to latent heat data. There are two different types of thermal object classes: SingleObject and SystemObjects. While the first only computes heat transfer processes of single thermal objects, the second can compute heat transfer processes of several thermal objects that can contact each other.</p>

<h2 id="database-of-materials">Database of materials</h2>

<p>A builtin database of materials is provided in the database folder. This database is very limited. The use of customized data can be done by defining the material data absolute path variable <code>file_name</code>. The builtin database includes several standard materials and can be consulted <a href='https://github.com/djsilva99/heatrapy/tree/master/heatrapy/database'>here</a>. Some folder names end with <code>_mag</code>. This means that the state of each point defines if a magnetic field is applied.</p>

<h2 id="visualization">Visualization</h2>

<p>Although the temperature data can be saved for each point and time in a csv file, the package also allows live visualization when using the SingleObject classes. By default, when initializing the related objects, the plotting of the temperature begins. The different live plot types are defined in the <code>draw</code> parameter. So far, one can plot the temperature, materials, heat power sources and state for SingleObject2D. Only the temperature can be plotted when using SingleObject1D.</p>

<h2 id="example">Example</h2>

<p>As an example, the code below computes 100 s of a Cu 2D solid with a water circle and a aluminum square.</p>

<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">heatrapy</span> <span class="k">as</span> <span class="nn">htp</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">htp</span><span class="o">.</span><span class="n">SingleObject2D</span><span class="p">(</span>
<span class="o">...</span>     <span class="mi">293</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">material</span><span class="o">=</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">change_material</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">material</span><span class="o">=</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">initial_point</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">length</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">change_material</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">material</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">initial_point</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">length</span><span class="o">=</span><span class="mi">4</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></div>

<p>The output at the end of the computation is the following:
<img src="https://github.com/danieljosesilva/heatrapy/blob/master/img/example.png?raw=true" width="750"></p>

<h2 id="changelog">Changelog</h2>

<p>The changelog can be consulted <a href='https://github.com/djsilva99/heatrapy/tree/master/CHANGELOG.md'>here</a>.</p>

<h2 id="license">License</h2>

<p>Heatrapy is licensed under the terms of the <a href='https://github.com/djsilva99/heatrapy/tree/master/LICENSE'>MIT License (MIT)</a>.</p>

<h2 id="contributing">Contributing</h2>

<p>Any type of contributions are welcome. A road map for future releases can be consulted in the <a href='https://github.com/djsilva99/heatrapy/wiki'>wiki pages</a>. Besides contributing by coding, feel free to report bugs and suggest new features. When contributing, please first discuss the change you wish to make via issue or email (djsilva@gmx.com), and then test the new code according to the <a href='https://github.com/djsilva99/heatrapy/tree/master/CONTRIBUTING.md'> contributing file</a>.</p>

<h2 id="citing-heatrapy">Citing Heatrapy</h2>

<p>Please acknowledge heatrapy if it contributes to a project that leads to a publication by citing <a href='https://github.com/djsilva99/heatrapy/wiki'>this paper</a>.</p>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Heatrapy stands for HEAt TRAnsfer in PYthon. It simulates dynamic 1D and 2D heat transfer processes in solids using the finite difference method. Heatrapy includes both the modeling of caloric effects and the incorporation of phase transitions.</span>

<span class="sd">author: Daniel Silva (djsilva@gmx.com) &lt;br&gt; current version: v2.0.1</span>

<span class="sd">Installation</span>
<span class="sd">------------</span>
<span class="sd">To install heatrapy use the pip package manager:</span>
<span class="sd">```bash</span>
<span class="sd">$ pip install heatrapy</span>
<span class="sd">```</span>
<span class="sd">To import the heatrapy module type in the python shell:</span>
<span class="sd">```python</span>
<span class="sd">&gt;&gt;&gt; import heatrapy as htp</span>
<span class="sd">```</span>

<span class="sd">Thermal object</span>
<span class="sd">--------------</span>
<span class="sd">Thermal objects are the building block of the heatrapy module. Each thermal object is defined by a range of discrete space, where each point incorporates thermal properties, power sources and temperature. Boundary conditions are also defined and can be changed at any time. Thermal objects can use several methods that change the sate of each point, materials properties, and power sources. The state of each point defines if a field is applied (if True) or not (if False). This is of paramount importance for caloric materials. Moreover, phase change transitions can be incorporated according to latent heat data. There are two different types of thermal object classes: SingleObject and SystemObjects. While the first only computes heat transfer processes of single thermal objects, the second can compute heat transfer processes of several thermal objects that can contact each other.</span>

<span class="sd">Database of materials</span>
<span class="sd">---------------------</span>
<span class="sd">A builtin database of materials is provided in the database folder. This database is very limited. The use of customized data can be done by defining the material data absolute path variable `file_name`. The builtin database includes several standard materials and can be consulted &lt;a href=&#39;https://github.com/djsilva99/heatrapy/tree/master/heatrapy/database&#39;&gt;here&lt;/a&gt;. Some folder names end with `_mag`. This means that the state of each point defines if a magnetic field is applied.</span>

<span class="sd">Visualization</span>
<span class="sd">-------------</span>
<span class="sd">Although the temperature data can be saved for each point and time in a csv file, the package also allows live visualization when using the SingleObject classes. By default, when initializing the related objects, the plotting of the temperature begins. The different live plot types are defined in the `draw` parameter. So far, one can plot the temperature, materials, heat power sources and state for SingleObject2D. Only the temperature can be plotted when using SingleObject1D.</span>

<span class="sd">Example</span>
<span class="sd">-------</span>
<span class="sd">As an example, the code below computes 100 s of a Cu 2D solid with a water circle and a aluminum square.</span>
<span class="sd">```python</span>
<span class="sd">&gt;&gt;&gt; import heatrapy as htp</span>
<span class="sd">&gt;&gt;&gt; example = htp.SingleObject2D(</span>
<span class="sd">...     293,</span>
<span class="sd">...     material=&#39;Cu&#39;,</span>
<span class="sd">...     boundaries=(300, 0, 0, 0),</span>
<span class="sd">...     size=(20, 20)</span>
<span class="sd">... )</span>
<span class="sd">&gt;&gt;&gt; example.change_material(</span>
<span class="sd">...     material=&#39;Al&#39;,</span>
<span class="sd">...     shape=&#39;square&#39;,</span>
<span class="sd">...     initial_point=(5, 2),</span>
<span class="sd">...     length=(4, 4)</span>
<span class="sd">... )</span>
<span class="sd">&gt;&gt;&gt; example.change_material(</span>
<span class="sd">...     material=&#39;water&#39;,</span>
<span class="sd">...     shape=&#39;circle&#39;,</span>
<span class="sd">...     initial_point=(5, 13),</span>
<span class="sd">...     length=4</span>
<span class="sd">... )</span>
<span class="sd">&gt;&gt;&gt; example.compute(100, 10)</span>
<span class="sd">```</span>
<span class="sd">The output at the end of the computation will be the following:</span>
<span class="sd">&lt;img src=&quot;https://github.com/danieljosesilva/heatrapy/blob/master/img/example.png&quot;&gt;</span>

<span class="sd">Changelog</span>
<span class="sd">---------</span>
<span class="sd">The changelog can be consulted &lt;a href=&#39;https://github.com/djsilva99/heatrapy/tree/master/CHANGELOG.md&#39;&gt;here&lt;/a&gt;.</span>

<span class="sd">License</span>
<span class="sd">-------</span>
<span class="sd">Heatrapy is licensed under the terms of the &lt;a href=&#39;https://github.com/djsilva99/heatrapy/tree/master/LICENSE&#39;&gt;MIT License (MIT)&lt;/a&gt;.</span>

<span class="sd">Contributing</span>
<span class="sd">------------</span>
<span class="sd">Any type of contributions are welcome. A road map for future releases can be consulted in the &lt;a href=&#39;https://github.com/djsilva99/heatrapy/wiki&#39;&gt;wiki pages&lt;/a&gt;. Besides contributing by coding, feel free to report bugs and suggest new features. When contributing, please first discuss the change you wish to make via issue or email (djsilva@gmx.com), and then test the new code according to the &lt;a href=&#39;https://github.com/djsilva99/heatrapy/tree/master/CONTRIBUTING.md&#39;&gt; contributing file&lt;/a&gt;.</span>

<span class="sd">Citing Heatrapy</span>
<span class="sd">-----------------</span>
<span class="sd">Please acknowledge heatrapy if it contributes to a project that leads to a publication by citing &lt;a href=&#39;https://github.com/djsilva99/heatrapy/wiki&#39;&gt;this paper&lt;/a&gt;.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.dimension_1.objects</span> <span class="kn">import</span> <span class="n">SystemObjects</span> <span class="k">as</span> <span class="n">SystemObjects1D</span>
<span class="kn">from</span> <span class="nn">.dimension_1.objects</span> <span class="kn">import</span> <span class="n">SingleObject</span> <span class="k">as</span> <span class="n">SingleObject1D</span>
<span class="kn">from</span> <span class="nn">.dimension_2.objects</span> <span class="kn">import</span> <span class="n">SystemObjects</span> <span class="k">as</span> <span class="n">SystemObjects2D</span>
<span class="kn">from</span> <span class="nn">.dimension_2.objects</span> <span class="kn">import</span> <span class="n">SingleObject</span> <span class="k">as</span> <span class="n">SingleObject2D</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SystemObjects1D&#39;</span><span class="p">,</span> <span class="s1">&#39;SingleObject1D&#39;</span><span class="p">,</span> <span class="s1">&#39;SystemObjects2D&#39;</span><span class="p">,</span>
           <span class="s1">&#39;SingleObject2D&#39;</span><span class="p">]</span>
</pre></div>

        </details>

            </section>
                <section id="SystemObjects1D">
                                <div class="attr class">
        <a class="headerlink" href="#SystemObjects1D">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SystemObjects1D</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SystemObjects</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;System_objects class.</span>

<span class="sd">    This class creates a system of unidimensional thermal objects, establishes</span>
<span class="sd">    contact between them and computes the respective thermal processes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_objects</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">),</span>
                 <span class="n">objects_length</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">amb_temperature</span><span class="o">=</span><span class="mi">293</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;System object initialization.</span>

<span class="sd">        `number_objects` is the integer number of thermal objects. `materials`</span>
<span class="sd">        is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `amb_temperature` is the ambient temperature of the</span>
<span class="sd">        whole system. `object_length` is the list of thermal object lengths</span>
<span class="sd">        (spacial steps). `dx` and `dt` are the space and time steps,</span>
<span class="sd">        respectively. `file_name` is the file name where the temperature is</span>
<span class="sd">        saved. `boundaries` is a list of tuples of length two that define each</span>
<span class="sd">        boundary condition for temperature. If 0 the boundary condition is</span>
<span class="sd">        insulation. `materials_path` is absolute path of the materials</span>
<span class="sd">        database. If false, then the materials database is the standard</span>
<span class="sd">        heatrapy database.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">objects_length</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">objects_length</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_objects</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects_length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="n">cond07</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># initial definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_objects</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span>
                                <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="n">materials</span><span class="p">[</span><span class="n">i</span><span class="p">],),</span>
                                <span class="n">borders</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">objects_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                                <span class="n">materials_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                                <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                                <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="mf">0.</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">contact_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter self.contacts by thermal object id.</span>

<span class="sd">        object: thermal object id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">object</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">object</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">object</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">contact_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add contact to self.contacts.</span>

<span class="sd">        The `contact` parameter is a tuple of length 3 (one element for thermal</span>
<span class="sd">        object A, one for thermal object B, and one for the heat transfer</span>
<span class="sd">        coefficient). Each thermal object element is a tuple of length 2 where</span>
<span class="sd">        the first element is the index of the thermal object and the second is</span>
<span class="sd">        the spatial point index.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">contact_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_one</span><span class="p">,</span> <span class="n">object_two</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Contact removal.</span>

<span class="sd">        Removes all contacts between `object_one` id and `object_two` id.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_one</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_two</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">contact_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contact_list</span><span class="p">)):</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">cond_1</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">cond_2</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="k">if</span> <span class="n">cond_1</span> <span class="ow">or</span> <span class="n">cond_2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change boundaries.</span>

<span class="sd">        Changes the `boundaries` of `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>

    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Four different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;`, `&#39;explicit_k(x)&#39;`,</span>
<span class="sd">        `&#39;implicit_general&#39;`, and `&#39;implicit_k(x)&#39;`. If `verbose = True`, then</span>
<span class="sd">        the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Q0_ref</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">:</span>
                <span class="n">ind1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ind2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">ind1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">ind2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">heat_contact_1</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td1</span> <span class="o">-</span> <span class="n">td2</span><span class="p">)</span>
                <span class="n">heat_contact_2</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td2</span> <span class="o">-</span> <span class="n">td1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">ind1</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_2</span>

            <span class="n">object_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">object_number</span> <span class="o">=</span> <span class="n">object_number</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">dt</span>

                <span class="n">cond1</span> <span class="o">=</span> <span class="n">object_number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">object_number</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">:</span>

                    <span class="c1"># defines the material properties</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">num_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                    <span class="c1"># SOLVERS</span>

                    <span class="c1"># implicit k constant</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_general&#39;</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

                    <span class="c1"># implicit k dependent on x</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

                    <span class="c1"># explicit k constant</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

                    <span class="c1"># explicit k dependent on x</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

                    <span class="c1"># writes the temperature to file_name file ...</span>
                    <span class="c1"># if the number of time steps is verified</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">heat</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">dx</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">heat</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">heat</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">heat</span><span class="p">)</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">object_number</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">+</span> <span class="n">heat</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">+</span> <span class="n">heat</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q2</span>

                    <span class="c1"># writes the temperature to file_name file ...</span>
                    <span class="c1"># if the number of time steps is verified</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">q</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;progress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>System_objects class.</p>

<p>This class creates a system of unidimensional thermal objects, establishes
contact between them and computes the respective thermal processes.</p>
</div>


                            <div id="SystemObjects1D.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SystemObjects1D</span><span class="signature">(
    self,
    number_objects=2,
    materials=(&#39;Cu&#39;, &#39;Cu&#39;),
    objects_length=(10, 10),
    amb_temperature=293,
    dx=0.01,
    dt=0.1,
    file_name=None,
    initial_state=False,
    boundaries=((2, 0), (3, 0)),
    materials_path=False
)</span>    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_objects</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">),</span>
                 <span class="n">objects_length</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">amb_temperature</span><span class="o">=</span><span class="mi">293</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;System object initialization.</span>

<span class="sd">        `number_objects` is the integer number of thermal objects. `materials`</span>
<span class="sd">        is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `amb_temperature` is the ambient temperature of the</span>
<span class="sd">        whole system. `object_length` is the list of thermal object lengths</span>
<span class="sd">        (spacial steps). `dx` and `dt` are the space and time steps,</span>
<span class="sd">        respectively. `file_name` is the file name where the temperature is</span>
<span class="sd">        saved. `boundaries` is a list of tuples of length two that define each</span>
<span class="sd">        boundary condition for temperature. If 0 the boundary condition is</span>
<span class="sd">        insulation. `materials_path` is absolute path of the materials</span>
<span class="sd">        database. If false, then the materials database is the standard</span>
<span class="sd">        heatrapy database.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">objects_length</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">objects_length</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_objects</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects_length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="n">cond07</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># initial definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_objects</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span>
                                <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="n">materials</span><span class="p">[</span><span class="n">i</span><span class="p">],),</span>
                                <span class="n">borders</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">objects_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                                <span class="n">materials_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                                <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                                <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="mf">0.</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>

        </details>

            <div class="docstring"><p>System object initialization.</p>

<p><code>number_objects</code> is the integer number of thermal objects. <code>materials</code>
is the list of strings of all the used materials present in
<code>material_path</code>. <code>amb_temperature</code> is the ambient temperature of the
whole system. <code>object_length</code> is the list of thermal object lengths
(spacial steps). <code>dx</code> and <code>dt</code> are the space and time steps,
respectively. <code>file_name</code> is the file name where the temperature is
saved. <code>boundaries</code> is a list of tuples of length two that define each
boundary condition for temperature. If 0 the boundary condition is
insulation. <code>materials_path</code> is absolute path of the materials
database. If false, then the materials database is the standard
heatrapy database.</p>
</div>


                            </div>
                            <div id="SystemObjects1D.contact_filter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.contact_filter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_filter</span><span class="signature">(self, object)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter self.contacts by thermal object id.</span>

<span class="sd">        object: thermal object id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">object</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">object</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">object</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Filter self.contacts by thermal object id.</p>

<p>object: thermal object id</p>
</div>


                            </div>
                            <div id="SystemObjects1D.contact_add" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.contact_add">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_add</span><span class="signature">(self, contact)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add contact to self.contacts.</span>

<span class="sd">        The `contact` parameter is a tuple of length 3 (one element for thermal</span>
<span class="sd">        object A, one for thermal object B, and one for the heat transfer</span>
<span class="sd">        coefficient). Each thermal object element is a tuple of length 2 where</span>
<span class="sd">        the first element is the index of the thermal object and the second is</span>
<span class="sd">        the spatial point index.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add contact to self.contacts.</p>

<p>The <code>contact</code> parameter is a tuple of length 3 (one element for thermal
object A, one for thermal object B, and one for the heat transfer
coefficient). Each thermal object element is a tuple of length 2 where
the first element is the index of the thermal object and the second is
the spatial point index.</p>
</div>


                            </div>
                            <div id="SystemObjects1D.contact_remove" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.contact_remove">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_remove</span><span class="signature">(self, object_one, object_two)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_one</span><span class="p">,</span> <span class="n">object_two</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Contact removal.</span>

<span class="sd">        Removes all contacts between `object_one` id and `object_two` id.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_one</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_two</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">contact_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contact_list</span><span class="p">)):</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">cond_1</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">cond_2</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="k">if</span> <span class="n">cond_1</span> <span class="ow">or</span> <span class="n">cond_2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

        </details>

            <div class="docstring"><p>Contact removal.</p>

<p>Removes all contacts between <code>object_one</code> id and <code>object_two</code> id.</p>
</div>


                            </div>
                            <div id="SystemObjects1D.change_boundaries" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.change_boundaries">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_boundaries</span><span class="signature">(self, object_id, boundaries)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change boundaries.</span>

<span class="sd">        Changes the `boundaries` of `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
</pre></div>

        </details>

            <div class="docstring"><p>Change boundaries.</p>

<p>Changes the <code>boundaries</code> of <code>object_id</code>.</p>
</div>


                            </div>
                            <div id="SystemObjects1D.compute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects1D.compute">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">compute</span><span class="signature">(
    self,
    time_interval,
    write_interval,
    solver=&#39;implicit_k(x)&#39;,
    verbose=True
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Four different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;`, `&#39;explicit_k(x)&#39;`,</span>
<span class="sd">        `&#39;implicit_general&#39;`, and `&#39;implicit_k(x)&#39;`. If `verbose = True`, then</span>
<span class="sd">        the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Q0_ref</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">:</span>
                <span class="n">ind1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ind2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">ind1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">ind2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">heat_contact_1</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td1</span> <span class="o">-</span> <span class="n">td2</span><span class="p">)</span>
                <span class="n">heat_contact_2</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td2</span> <span class="o">-</span> <span class="n">td1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">ind2</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">ind1</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_2</span>

            <span class="n">object_number</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">object_number</span> <span class="o">=</span> <span class="n">object_number</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">dt</span>

                <span class="n">cond1</span> <span class="o">=</span> <span class="n">object_number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">object_number</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">:</span>

                    <span class="c1"># defines the material properties</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">num_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                    <span class="c1"># SOLVERS</span>

                    <span class="c1"># implicit k constant</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_general&#39;</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

                    <span class="c1"># implicit k dependent on x</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

                    <span class="c1"># explicit k constant</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

                    <span class="c1"># explicit k dependent on x</span>
                    <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

                    <span class="c1"># writes the temperature to file_name file ...</span>
                    <span class="c1"># if the number of time steps is verified</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">heat</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">dx</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">heat</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">heat</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">heat</span><span class="p">)</span><span class="o">*</span><span class="n">obj</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">object_number</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">+</span> <span class="n">heat</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">+</span> <span class="n">heat</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q2</span>

                    <span class="c1"># writes the temperature to file_name file ...</span>
                    <span class="c1"># if the number of time steps is verified</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">q</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;progress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Compute the thermal process.</p>

<p>Computes the system for <code>time_interval</code>, and writes into the
<code>file_name</code> file every <code>write_interval</code> time steps. Four different
solvers can be used: <code>'explicit_general'</code>, <code>'explicit_k(x)'</code>,
<code>'implicit_general'</code>, and <code>'implicit_k(x)'</code>. If <code>verbose = True</code>, then
the progress of the computation is shown.</p>
</div>


                            </div>
                </section>
                <section id="SingleObject1D">
                                <div class="attr class">
        <a class="headerlink" href="#SingleObject1D">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SingleObject1D</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SingleObject</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Single_object class.</span>

<span class="sd">    This class solves numerically the heat conduction equation for 1 dimension</span>
<span class="sd">    of a single material(s). The class has 6 methods.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amb_temperature</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,),</span> <span class="n">borders</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
                 <span class="n">materials_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Thermal object initialization.</span>

<span class="sd">        `amb_temperature` is the ambient temperature of the whole system.</span>
<span class="sd">        `materials` is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `borders` is a list of the points where there is a</span>
<span class="sd">        change of material. `materials_order` is a list of the materials list</span>
<span class="sd">        indexes that defines the material properties given by borders. `dx` and</span>
<span class="sd">        `dt` are the space and time steps, respectively. `file_name` is the</span>
<span class="sd">        file name where the temperature is saved. `boundaries` is a list of two</span>
<span class="sd">        entries that define the boundary condition for temperature. If 0 the</span>
<span class="sd">        boundary condition is insulation. `initial_state` is the initial state</span>
<span class="sd">        of the materials. True if there are an applied field and False if them</span>
<span class="sd">        field is absent. `materials_path` is absolute path of the materials</span>
<span class="sd">        database. If false, then the materials database is the standard</span>
<span class="sd">        heatrapy database. `draw` is a list of strings representing the online</span>
<span class="sd">        plots. In this version only `&#39;temperature&#39;` can be potted. If the list</span>
<span class="sd">        is empty, then no drawing is performed. `draw_scale` is a list of two</span>
<span class="sd">        values, representing the minimum and maximum temperature to be drawn.</span>
<span class="sd">        If None, there are no limits.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">borders</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">borders</span><span class="p">)</span>
        <span class="n">materials_order</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials_order</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">borders</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials_order</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="n">cond07</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond15</span> <span class="ow">and</span> <span class="n">cond16</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="n">materials</span><span class="p">,</span>
                             <span class="n">borders</span><span class="o">=</span><span class="n">borders</span><span class="p">,</span> <span class="n">materials_order</span><span class="o">=</span><span class="n">materials_order</span><span class="p">,</span>
                             <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                             <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span>
                             <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                             <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">)</span>

        <span class="c1"># initializes the plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">draw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperature (K)&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure_type</span><span class="p">,</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting.</span>

<span class="sd">        Initializes a specific live plotting. `figure_type` is a string</span>
<span class="sd">        identifying the plotting. This version only allows the plotting of the</span>
<span class="sd">        &#39;temperature&#39;. `draw_scale` defines the range of temperatures. If None,</span>
<span class="sd">        this range is found automatically for every frame.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">figure_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">figure_type</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperature (K)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation.</span>

<span class="sd">        Activates the thermal object between `initial_point` to `final_point`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deactivation.</span>

<span class="sd">        Deactivates the thermal object between `initial_point` to</span>
<span class="sd">        `final_point`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">deactivate</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">change_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power_type</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Heat power source change.</span>

<span class="sd">        Changes the coeficients for the heat power sources by a value of power</span>
<span class="sd">        from `initial_point` to `final_point`. `power_type` is a string that</span>
<span class="sd">        represents the type of coefficient, i.e. &#39;Q&#39; or &#39;Q0&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">or</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>
        <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>

    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boundary change.</span>

<span class="sd">        Changes the `boundaries` variable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>

    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for time_interval seconds, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Four different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;`, `&#39;explicit_k(x)&#39;`,</span>
<span class="sd">        `&#39;implicit_general&#39;`, and `&#39;implicit_k(x)&#39;`. If `verbose = True`, then</span>
<span class="sd">        the progress of the computation progress is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">all_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;implicit_general&#39;</span><span class="p">,</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="ow">in</span> <span class="n">all_solvers</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>

            <span class="c1"># updates the time_passed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span>

            <span class="c1"># defines the material properties accoring to the state list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">num_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># SOLVERS</span>
            <span class="c1"># implicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_general&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># implicit k dependent on x</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># explicit k dependent on x</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

            <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span>
                            <span class="k">if</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>

            <span class="c1"># writes the temperature to file_name file ...</span>
            <span class="c1"># if the number of time steps is verified</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                        <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pogress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Single_object class.</p>

<p>This class solves numerically the heat conduction equation for 1 dimension
of a single material(s). The class has 6 methods.</p>
</div>


                            <div id="SingleObject1D.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SingleObject1D</span><span class="signature">(
    self,
    amb_temperature,
    materials=(&#39;Cu&#39;,),
    borders=(1, 11),
    materials_order=(0,),
    dx=0.01,
    dt=0.1,
    file_name=None,
    boundaries=(0, 0),
    initial_state=False,
    materials_path=False,
    draw=[&#39;temperature&#39;],
    draw_scale=None
)</span>    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amb_temperature</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,),</span> <span class="n">borders</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
                 <span class="n">materials_order</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">draw</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Thermal object initialization.</span>

<span class="sd">        `amb_temperature` is the ambient temperature of the whole system.</span>
<span class="sd">        `materials` is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `borders` is a list of the points where there is a</span>
<span class="sd">        change of material. `materials_order` is a list of the materials list</span>
<span class="sd">        indexes that defines the material properties given by borders. `dx` and</span>
<span class="sd">        `dt` are the space and time steps, respectively. `file_name` is the</span>
<span class="sd">        file name where the temperature is saved. `boundaries` is a list of two</span>
<span class="sd">        entries that define the boundary condition for temperature. If 0 the</span>
<span class="sd">        boundary condition is insulation. `initial_state` is the initial state</span>
<span class="sd">        of the materials. True if there are an applied field and False if them</span>
<span class="sd">        field is absent. `materials_path` is absolute path of the materials</span>
<span class="sd">        database. If false, then the materials database is the standard</span>
<span class="sd">        heatrapy database. `draw` is a list of strings representing the online</span>
<span class="sd">        plots. In this version only `&#39;temperature&#39;` can be potted. If the list</span>
<span class="sd">        is empty, then no drawing is performed. `draw_scale` is a list of two</span>
<span class="sd">        values, representing the minimum and maximum temperature to be drawn.</span>
<span class="sd">        If None, there are no limits.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">borders</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">borders</span><span class="p">)</span>
        <span class="n">materials_order</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials_order</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">borders</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials_order</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="n">cond07</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">draw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond15</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond16</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond15</span> <span class="ow">and</span> <span class="n">cond16</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="n">materials</span><span class="p">,</span>
                             <span class="n">borders</span><span class="o">=</span><span class="n">borders</span><span class="p">,</span> <span class="n">materials_order</span><span class="o">=</span><span class="n">materials_order</span><span class="p">,</span>
                             <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                             <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span>
                             <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                             <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">)</span>

        <span class="c1"># initializes the plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">draw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperature (K)&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Thermal object initialization.</p>

<p><code>amb_temperature</code> is the ambient temperature of the whole system.
<code>materials</code> is the list of strings of all the used materials present in
<code>material_path</code>. <code>borders</code> is a list of the points where there is a
change of material. <code>materials_order</code> is a list of the materials list
indexes that defines the material properties given by borders. <code>dx</code> and
<code>dt</code> are the space and time steps, respectively. <code>file_name</code> is the
file name where the temperature is saved. <code>boundaries</code> is a list of two
entries that define the boundary condition for temperature. If 0 the
boundary condition is insulation. <code>initial_state</code> is the initial state
of the materials. True if there are an applied field and False if them
field is absent. <code>materials_path</code> is absolute path of the materials
database. If false, then the materials database is the standard
heatrapy database. <code>draw</code> is a list of strings representing the online
plots. In this version only <code>'temperature'</code> can be potted. If the list
is empty, then no drawing is performed. <code>draw_scale</code> is a list of two
values, representing the minimum and maximum temperature to be drawn.
If None, there are no limits.</p>
</div>


                            </div>
                            <div id="SingleObject1D.show_figure" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.show_figure">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">show_figure</span><span class="signature">(self, figure_type, draw_scale=None)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">show_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure_type</span><span class="p">,</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting.</span>

<span class="sd">        Initializes a specific live plotting. `figure_type` is a string</span>
<span class="sd">        identifying the plotting. This version only allows the plotting of the</span>
<span class="sd">        &#39;temperature&#39;. `draw_scale` defines the range of temperatures. If None,</span>
<span class="sd">        this range is found automatically for every frame.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">figure_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">figure_type</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">x_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dx</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;temperature (K)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Plotting.</p>

<p>Initializes a specific live plotting. <code>figure_type</code> is a string
identifying the plotting. This version only allows the plotting of the
'temperature'. <code>draw_scale</code> defines the range of temperatures. If None,
this range is found automatically for every frame.</p>
</div>


                            </div>
                            <div id="SingleObject1D.activate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.activate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">activate</span><span class="signature">(self, initial_point, final_point)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation.</span>

<span class="sd">        Activates the thermal object between `initial_point` to `final_point`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Activation.</p>

<p>Activates the thermal object between <code>initial_point</code> to <code>final_point</code>.</p>
</div>


                            </div>
                            <div id="SingleObject1D.deactivate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.deactivate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">deactivate</span><span class="signature">(self, initial_point, final_point)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deactivation.</span>

<span class="sd">        Deactivates the thermal object between `initial_point` to</span>
<span class="sd">        `final_point`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">deactivate</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                            <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Deactivation.</p>

<p>Deactivates the thermal object between <code>initial_point</code> to
<code>final_point</code>.</p>
</div>


                            </div>
                            <div id="SingleObject1D.change_power" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.change_power">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_power</span><span class="signature">(self, power_type, power, initial_point, final_point)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power_type</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Heat power source change.</span>

<span class="sd">        Changes the coeficients for the heat power sources by a value of power</span>
<span class="sd">        from `initial_point` to `final_point`. `power_type` is a string that</span>
<span class="sd">        represents the type of coefficient, i.e. &#39;Q&#39; or &#39;Q0&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">or</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>
        <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>
</pre></div>

        </details>

            <div class="docstring"><p>Heat power source change.</p>

<p>Changes the coeficients for the heat power sources by a value of power
from <code>initial_point</code> to <code>final_point</code>. <code>power_type</code> is a string that
represents the type of coefficient, i.e. 'Q' or 'Q0'.</p>
</div>


                            </div>
                            <div id="SingleObject1D.change_boundaries" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.change_boundaries">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_boundaries</span><span class="signature">(self, boundaries)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boundary change.</span>

<span class="sd">        Changes the `boundaries` variable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
</pre></div>

        </details>

            <div class="docstring"><p>Boundary change.</p>

<p>Changes the <code>boundaries</code> variable.</p>
</div>


                            </div>
                            <div id="SingleObject1D.compute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject1D.compute">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">compute</span><span class="signature">(
    self,
    time_interval,
    write_interval,
    solver=&#39;explicit_k(x)&#39;,
    verbose=True
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for time_interval seconds, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Four different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;`, `&#39;explicit_k(x)&#39;`,</span>
<span class="sd">        `&#39;implicit_general&#39;`, and `&#39;implicit_k(x)&#39;`. If `verbose = True`, then</span>
<span class="sd">        the progress of the computation progress is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">all_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;implicit_general&#39;</span><span class="p">,</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="ow">in</span> <span class="n">all_solvers</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>

            <span class="c1"># updates the time_passed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span>

            <span class="c1"># defines the material properties accoring to the state list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">num_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># SOLVERS</span>
            <span class="c1"># implicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_general&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># implicit k dependent on x</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;implicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">implicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># explicit k dependent on x</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>

            <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span>
                            <span class="k">if</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">)):</span>
                                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">vmin</span><span class="p">:</span>
                                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span> <span class="o">-</span> <span class="mf">0.1</span>
                                        <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span> <span class="o">+</span> <span class="mf">0.1</span>
                                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">])</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>

            <span class="c1"># writes the temperature to file_name file ...</span>
            <span class="c1"># if the number of time steps is verified</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">time_passed</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
                        <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pogress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">j</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Compute the thermal process.</p>

<p>Computes the system for time_interval seconds, and writes into the
<code>file_name</code> file every <code>write_interval</code> time steps. Four different
solvers can be used: <code>'explicit_general'</code>, <code>'explicit_k(x)'</code>,
<code>'implicit_general'</code>, and <code>'implicit_k(x)'</code>. If <code>verbose = True</code>, then
the progress of the computation progress is shown.</p>
</div>


                            </div>
                </section>
                <section id="SystemObjects2D">
                                <div class="attr class">
        <a class="headerlink" href="#SystemObjects2D">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SystemObjects2D</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SystemObjects</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;System_objects class.</span>

<span class="sd">    This class creates a system of 2D thermal objects, establishes contact</span>
<span class="sd">    between them and computes the respective thermal processes.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_objects</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">),</span>
                 <span class="n">objects_length</span><span class="o">=</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">amb_temperature</span><span class="o">=</span><span class="mi">293</span><span class="p">,</span>
                 <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;System object initialization.</span>

<span class="sd">        `number_objects` is the integer number of thermal objects. `materials`</span>
<span class="sd">        is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `amb_temperature` is the ambient temperature of the</span>
<span class="sd">        whole system. `object_length` is the list of thermal object lengths</span>
<span class="sd">        (tuple of spacial steps). `dx` and `dy` are the space steps along the</span>
<span class="sd">        x- and y-axis, respectively. dt is the time step. `file_name` is the</span>
<span class="sd">        file name where the temperature is saved. `boundaries` is a list of</span>
<span class="sd">        four entries that define the boundary condition for temperature (left,</span>
<span class="sd">        right, bottom, top). If 0, the boundary condition is insulation.</span>
<span class="sd">        `materials_path` is absolute path of the materials database. If false,</span>
<span class="sd">        then the materials database is the standard heatrapy database.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">objects_length</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">objects_length</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_objects</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects_length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="n">cond08</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># initial definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">file_name_obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_objects</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="n">file_name_obj</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">materials</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                       <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                                       <span class="n">file_name</span><span class="o">=</span><span class="n">file_name_obj</span><span class="p">,</span>
                                       <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span>
                                       <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                                       <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="k">def</span> <span class="nf">contact_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter thermal contacts.</span>

<span class="sd">        Filter thermal contacts by `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">object_id</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">contact_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add contact to self.contacts.</span>

<span class="sd">        `contact` is a thermal contact tuple of length 3, where the first and</span>
<span class="sd">        second entries correspond to tuples of the thermal objects and points</span>
<span class="sd">        (object_id, (x,y)), and the third entry is the heat transfer</span>
<span class="sd">        coefficient.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">contact_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_one</span><span class="p">,</span> <span class="n">object_two</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Contact removal.</span>

<span class="sd">        Removes all contacts between `object_one` id and `object_two` id.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_one</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_two</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">contact_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contact_list</span><span class="p">)):</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">cond_1</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">cond_2</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="k">if</span> <span class="n">cond_1</span> <span class="ow">or</span> <span class="n">cond_2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change boundaries.</span>

<span class="sd">        Changes the `boundaries` variable of `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>

    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Two different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;` and `&#39;explicit_k(x)&#39;`. If</span>
<span class="sd">        verbose = True, then the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given time_interval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Q0_ref</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">:</span>
                <span class="n">in1_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">in1_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">in2_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">in2_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">in1_x</span><span class="p">][</span><span class="n">in1_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">in2_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">heat_contact_1</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td1</span> <span class="o">-</span> <span class="n">td2</span><span class="p">)</span>
                <span class="n">heat_contact_2</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td2</span> <span class="o">-</span> <span class="n">td1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">in2_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">in1_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_2</span>

            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">dt</span>

                <span class="c1"># defines the material properties</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># explicit k constant</span>
                <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># explicit k constant</span>
                <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;progress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>System_objects class.</p>

<p>This class creates a system of 2D thermal objects, establishes contact
between them and computes the respective thermal processes.</p>
</div>


                            <div id="SystemObjects2D.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SystemObjects2D</span><span class="signature">(
    self,
    number_objects=2,
    materials=(&#39;Cu&#39;, &#39;Cu&#39;),
    objects_length=((10, 10), (10, 10)),
    amb_temperature=293,
    dx=0.01,
    dy=0.01,
    dt=0.1,
    file_name=None,
    initial_state=False,
    boundaries=((0, 0, 0, 0), (0, 0, 0, 0)),
    materials_path=False
)</span>    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_objects</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">),</span>
                 <span class="n">objects_length</span><span class="o">=</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">amb_temperature</span><span class="o">=</span><span class="mi">293</span><span class="p">,</span>
                 <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;System object initialization.</span>

<span class="sd">        `number_objects` is the integer number of thermal objects. `materials`</span>
<span class="sd">        is the list of strings of all the used materials present in</span>
<span class="sd">        `material_path`. `amb_temperature` is the ambient temperature of the</span>
<span class="sd">        whole system. `object_length` is the list of thermal object lengths</span>
<span class="sd">        (tuple of spacial steps). `dx` and `dy` are the space steps along the</span>
<span class="sd">        x- and y-axis, respectively. dt is the time step. `file_name` is the</span>
<span class="sd">        file name where the temperature is saved. `boundaries` is a list of</span>
<span class="sd">        four entries that define the boundary condition for temperature (left,</span>
<span class="sd">        right, bottom, top). If 0, the boundary condition is insulation.</span>
<span class="sd">        `materials_path` is absolute path of the materials database. If false,</span>
<span class="sd">        then the materials database is the standard heatrapy database.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="n">objects_length</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">objects_length</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">materials</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond03</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number_objects</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond04</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objects_length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="n">cond08</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond03</span> <span class="ow">and</span> <span class="n">cond04</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># initial definitions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">file_name_obj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_objects</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
                <span class="n">file_name_obj</span> <span class="o">=</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">materials</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                       <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                                       <span class="n">file_name</span><span class="o">=</span><span class="n">file_name_obj</span><span class="p">,</span>
                                       <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span>
                                       <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                                       <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q2</span> <span class="o">=</span> <span class="mf">0.</span>
</pre></div>

        </details>

            <div class="docstring"><p>System object initialization.</p>

<p><code>number_objects</code> is the integer number of thermal objects. <code>materials</code>
is the list of strings of all the used materials present in
<code>material_path</code>. <code>amb_temperature</code> is the ambient temperature of the
whole system. <code>object_length</code> is the list of thermal object lengths
(tuple of spacial steps). <code>dx</code> and <code>dy</code> are the space steps along the
x- and y-axis, respectively. dt is the time step. <code>file_name</code> is the
file name where the temperature is saved. <code>boundaries</code> is a list of
four entries that define the boundary condition for temperature (left,
right, bottom, top). If 0, the boundary condition is insulation.
<code>materials_path</code> is absolute path of the materials database. If false,
then the materials database is the standard heatrapy database.</p>
</div>


                            </div>
                            <div id="SystemObjects2D.contact_filter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.contact_filter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_filter</span><span class="signature">(self, object_id)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filter thermal contacts.</span>

<span class="sd">        Filter thermal contacts by `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">object_id</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">filtered</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Filter thermal contacts.</p>

<p>Filter thermal contacts by <code>object_id</code>.</p>
</div>


                            </div>
                            <div id="SystemObjects2D.contact_add" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.contact_add">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_add</span><span class="signature">(self, contact)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add contact to self.contacts.</span>

<span class="sd">        `contact` is a thermal contact tuple of length 3, where the first and</span>
<span class="sd">        second entries correspond to tuples of the thermal objects and points</span>
<span class="sd">        (object_id, (x,y)), and the third entry is the heat transfer</span>
<span class="sd">        coefficient.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add contact to self.contacts.</p>

<p><code>contact</code> is a thermal contact tuple of length 3, where the first and
second entries correspond to tuples of the thermal objects and points
(object_id, (x,y)), and the third entry is the heat transfer
coefficient.</p>
</div>


                            </div>
                            <div id="SystemObjects2D.contact_remove" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.contact_remove">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">contact_remove</span><span class="signature">(self, object_one, object_two)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">contact_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_one</span><span class="p">,</span> <span class="n">object_two</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Contact removal.</span>

<span class="sd">        Removes all contacts between `object_one` id and `object_two` id.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_one</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_two</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">contact_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contact_list</span><span class="p">)):</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="n">cond_1</span> <span class="o">=</span> <span class="n">cond_1</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_two</span>
            <span class="n">cond_2</span> <span class="o">=</span> <span class="n">cond_2</span> <span class="ow">and</span> <span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">object_one</span>
            <span class="k">if</span> <span class="n">cond_1</span> <span class="ow">or</span> <span class="n">cond_2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">contact_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

        </details>

            <div class="docstring"><p>Contact removal.</p>

<p>Removes all contacts between <code>object_one</code> id and <code>object_two</code> id.</p>
</div>


                            </div>
                            <div id="SystemObjects2D.change_boundaries" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.change_boundaries">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_boundaries</span><span class="signature">(self, object_id, boundaries)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_id</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change boundaries.</span>

<span class="sd">        Changes the `boundaries` variable of `object_id`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">object_id</span><span class="p">]</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
</pre></div>

        </details>

            <div class="docstring"><p>Change boundaries.</p>

<p>Changes the <code>boundaries</code> variable of <code>object_id</code>.</p>
</div>


                            </div>
                            <div id="SystemObjects2D.compute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SystemObjects2D.compute">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">compute</span><span class="signature">(
    self,
    time_interval,
    write_interval,
    solver=&#39;explicit_k(x)&#39;,
    verbose=True
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Two different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;` and `&#39;explicit_k(x)&#39;`. If</span>
<span class="sd">        verbose = True, then the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given time_interval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">Q0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Q0_ref</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">contacts</span><span class="p">:</span>
                <span class="n">in1_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">in1_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">in2_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">in2_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">in1_x</span><span class="p">][</span><span class="n">in1_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">in2_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">heat_contact_1</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td1</span> <span class="o">-</span> <span class="n">td2</span><span class="p">)</span>
                <span class="n">heat_contact_2</span> <span class="o">=</span> <span class="n">contact</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">td2</span> <span class="o">-</span> <span class="n">td1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">in2_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">contact</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Q0</span><span class="p">[</span><span class="n">in1_x</span><span class="p">][</span><span class="n">in2_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">heat_contact_2</span>

            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">dt</span>

                <span class="c1"># defines the material properties</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                            <span class="n">obj</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># explicit k constant</span>
                <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># explicit k constant</span>
                <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_passed</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                                <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;progress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Compute the thermal process.</p>

<p>Computes the system for <code>time_interval</code>, and writes into the
<code>file_name</code> file every <code>write_interval</code> time steps. Two different
solvers can be used: <code>'explicit_general'</code> and <code>'explicit_k(x)'</code>. If
verbose = True, then the progress of the computation is shown.</p>
</div>


                            </div>
                </section>
                <section id="SingleObject2D">
                                <div class="attr class">
        <a class="headerlink" href="#SingleObject2D">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">SingleObject2D</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">SingleObject</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Single_object class.</span>

<span class="sd">    This class solves numerically the two-dimensional heat conduction equation.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                 <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">draw</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;materials&#39;</span><span class="p">],</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Object initialization.</span>

<span class="sd">        `amb_temperature` is the ambient temperature of the whole system.</span>
<span class="sd">        `materials` is the background material present in `material_path`.</span>
<span class="sd">        `dx`, `dy` are the space steps along the x- and y-axis, respectively.</span>
<span class="sd">        `dt` is the time step. `file_name` is the file name where the</span>
<span class="sd">        temperature is saved. `boundaries` is a list of four entries that</span>
<span class="sd">        define the boundary condition for temperature (left, right, bottom,</span>
<span class="sd">        top). If 0 the boundary condition is insulation. `initial_state` is the</span>
<span class="sd">        initial state of the materials. True if there are an applied field and</span>
<span class="sd">        False if them field is absent. `materials_path` is absolute path of the</span>
<span class="sd">        materials database. If false, then the materials database is the</span>
<span class="sd">        standard heatrapy database. `draw` is a list of strings representing</span>
<span class="sd">        the online plots. In this version live plotting can be performed for</span>
<span class="sd">        `temperature`, `materials`, `state`, `Q` and `Q0`. If the list is</span>
<span class="sd">        empty, then no drawing is performed. `draw_scale` is a list of two</span>
<span class="sd">        values, representing the minimum and maximum temperature to be drawn.</span>
<span class="sd">        If None, there are no limits. `Q` is a list of fixed heat source</span>
<span class="sd">        coefficient and `Q0` is a list of temperature dependent heat source</span>
<span class="sd">        coefficient.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="n">cond08</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">cond11</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond12</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q0</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond13</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond14</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond14</span> <span class="o">=</span> <span class="n">cond14</span> <span class="ow">or</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span> <span class="ow">and</span> <span class="n">cond11</span> <span class="ow">and</span> <span class="n">cond12</span> <span class="ow">and</span> <span class="n">cond13</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond14</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span> <span class="o">=</span> <span class="n">materials_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span>
                             <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                             <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span>
                             <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                             <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">)</span>

        <span class="c1"># Initializes plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">draw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;my_cmap_r&#39;</span>
            <span class="n">reverse</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_segmentdata</span><span class="p">:</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_segmentdata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">reverse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">linear</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">reverse</span><span class="p">))</span>
            <span class="n">my_cmap_r</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">linear</span><span class="p">)</span>
            <span class="n">cmap_r</span> <span class="o">=</span> <span class="n">my_cmap_r</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_r</span><span class="p">,</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                                 <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_r</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span>
                                                   <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">state</span><span class="p">),</span>
                                                         <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">])</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                    <span class="n">cbar_stat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="p">,</span>
                                                              <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="p">,</span>
                                                              <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="n">cbar_stat</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                                 <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                                 <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
                    <span class="n">value_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
                    <span class="n">value_2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span> <span class="n">value_2</span><span class="p">)</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                    <span class="n">value_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span>
                    <span class="n">value_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span>
                    <span class="n">cbar_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span>
                                                               <span class="n">ax</span><span class="o">=</span><span class="n">value_2</span><span class="p">,</span>
                                                               <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="n">cbar_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="p">,</span>
                                                     <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q (W/m²)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                                   <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                                   <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                   <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                   <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="p">,</span>
                                                      <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q0 (W/m²)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting.</span>

<span class="sd">        Initializes a specific plotting. `figure_type` is a string identifying</span>
<span class="sd">        the plotting. In this version live plotting can be performed for</span>
<span class="sd">        `temperature`, `materials`, `state`, `Q` and `Q0`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">figure_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">figure_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                         <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;temperature (K)&quot;</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># &quot;state&quot;</span>
            <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">])</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">cbar_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="p">,</span>
                                                       <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="p">,</span>
                                                       <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar_state</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;PiYG&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                         <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">materials_name_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
            <span class="n">materials_name_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">materials_name_list</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                           <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">cbar_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span><span class="p">,</span>
                                                       <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="p">,</span>
                                                       <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q (W/m²)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                           <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                           <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                           <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q0 (W/m²)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation of the material.</span>

<span class="sd">        Activates a given piece of material. If `shape` is `&#39;square&#39;`, then the</span>
<span class="sd">        `initial_point` is the tuple (x,y) of the bottom left point and the</span>
<span class="sd">        `final_point` is the tuple (x,y) of the top right point. If the shape</span>
<span class="sd">        is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the center of</span>
<span class="sd">        the circle and `final_point` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span>
                             <span class="n">final_point</span><span class="o">=</span><span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deactivation of the material.</span>

<span class="sd">        Deactivates a given piece of material. If `shape` is `&#39;square&#39;`, then</span>
<span class="sd">        the `initial_point` is the tuple (x,y) of the bottom left point and the</span>
<span class="sd">        `final_point` is the tuple (x,y) of the top right point. If the shape</span>
<span class="sd">        is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the center of</span>
<span class="sd">        the circle and `final_point` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">deactivate</span><span class="p">(</span><span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span>
                               <span class="n">final_point</span><span class="o">=</span><span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boundary change.</span>

<span class="sd">        Changes the `boundaries` variable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>

    <span class="k">def</span> <span class="nf">change_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span>
                        <span class="n">state</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Material change.</span>

<span class="sd">        Changes the material of a given piece of the background material. If</span>
<span class="sd">        `shape` is `&#39;square&#39;`, then the initial_point is the tuple (x,y) of the</span>
<span class="sd">        bottom left point and the `length` is the tuple (x,y) of the length. If</span>
<span class="sd">        the shape is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the</span>
<span class="sd">        center of the circle and `length` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
                               <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">materials_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
                               <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">materials_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;PiYG&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                             <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                             <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                             <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                             <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                             <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">materials_name_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
                <span class="n">materials_name_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">materials_name_list</span><span class="p">)</span>
                <span class="n">value_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
                <span class="n">value_2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span> <span class="n">value_2</span><span class="p">)</span>
                <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                <span class="n">cba_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span><span class="p">,</span>
                                                          <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="p">,</span>
                                                          <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                <span class="n">cba_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span>
                     <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Power change.</span>

<span class="sd">        Changes the power matrix of the thermal object. If `shape` is</span>
<span class="sd">        `&#39;square&#39;`, then the `initial_point` is the tuple (x,y) of the bottom</span>
<span class="sd">        left point and the `final_point` is the tuple (x,y) of the top right</span>
<span class="sd">        point. If the `shape` is `&#39;circle&#39;`, the `initial_point` is the tuple</span>
<span class="sd">        (x,y) of the center of the circle and `final_point` is its radius.</span>
<span class="sd">        `power` is the value of the power to add, and `power_type` is the type</span>
<span class="sd">        of power to be introduced, which has the value `&#39;Q&#39;` if it is</span>
<span class="sd">        temperature dependent and `&#39;Q0&#39;` if it is temperature independent.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">or</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">power_add</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span>
                                  <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="o">=</span><span class="n">power_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">power_add</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span>
                                  <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="o">=</span><span class="n">power_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="ow">and</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">))</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;Q0&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="ow">and</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">))</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_general&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Two different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;` and `&#39;explicit_k(x)&#39;`. If</span>
<span class="sd">        verbose = True, then the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">all_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;explicit_general&#39;</span><span class="p">,</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">]</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">solver</span> <span class="ow">in</span> <span class="n">all_solvers</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>

            <span class="c1"># updates the time_passed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span>

            <span class="c1"># defines the material properties accoring to the state list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># SOLVERS</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                    <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pogress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Single_object class.</p>

<p>This class solves numerically the two-dimensional heat conduction equation.</p>
</div>


                            <div id="SingleObject2D.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">SingleObject2D</span><span class="signature">(
    self,
    amb_temperature,
    material=&#39;Cu&#39;,
    dx=0.01,
    dy=0.01,
    dt=0.1,
    size=(10, 10),
    file_name=None,
    boundaries=(0, 0, 0, 0),
    Q=[],
    Q0=[],
    initial_state=False,
    materials_path=False,
    draw=[&#39;temperature&#39;, &#39;materials&#39;],
    draw_scale=None
)</span>    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                 <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">boundaries</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span> <span class="n">initial_state</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">materials_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">draw</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;materials&#39;</span><span class="p">],</span> <span class="n">draw_scale</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Object initialization.</span>

<span class="sd">        `amb_temperature` is the ambient temperature of the whole system.</span>
<span class="sd">        `materials` is the background material present in `material_path`.</span>
<span class="sd">        `dx`, `dy` are the space steps along the x- and y-axis, respectively.</span>
<span class="sd">        `dt` is the time step. `file_name` is the file name where the</span>
<span class="sd">        temperature is saved. `boundaries` is a list of four entries that</span>
<span class="sd">        define the boundary condition for temperature (left, right, bottom,</span>
<span class="sd">        top). If 0 the boundary condition is insulation. `initial_state` is the</span>
<span class="sd">        initial state of the materials. True if there are an applied field and</span>
<span class="sd">        False if them field is absent. `materials_path` is absolute path of the</span>
<span class="sd">        materials database. If false, then the materials database is the</span>
<span class="sd">        standard heatrapy database. `draw` is a list of strings representing</span>
<span class="sd">        the online plots. In this version live plotting can be performed for</span>
<span class="sd">        `temperature`, `materials`, `state`, `Q` and `Q0`. If the list is</span>
<span class="sd">        empty, then no drawing is performed. `draw_scale` is a list of two</span>
<span class="sd">        values, representing the minimum and maximum temperature to be drawn.</span>
<span class="sd">        If None, there are no limits. `Q` is a list of fixed heat source</span>
<span class="sd">        coefficient and `Q0` is a list of temperature dependent heat source</span>
<span class="sd">        coefficient.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond01</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond02</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond05</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond06</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond07</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="n">cond08</span> <span class="o">=</span> <span class="n">cond08</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cond09</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond10</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">cond11</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond12</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q0</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond13</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">cond14</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">draw_scale</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="n">cond14</span> <span class="o">=</span> <span class="n">cond14</span> <span class="ow">or</span> <span class="n">draw_scale</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond01</span> <span class="ow">and</span> <span class="n">cond02</span> <span class="ow">and</span> <span class="n">cond05</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond06</span> <span class="ow">and</span> <span class="n">cond07</span> <span class="ow">and</span> <span class="n">cond08</span> <span class="ow">and</span> <span class="n">cond09</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond10</span> <span class="ow">and</span> <span class="n">cond11</span> <span class="ow">and</span> <span class="n">cond12</span> <span class="ow">and</span> <span class="n">cond13</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="n">cond14</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span> <span class="o">=</span> <span class="n">materials_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">Object</span><span class="p">(</span><span class="n">amb_temperature</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span>
                             <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                             <span class="n">boundaries</span><span class="o">=</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="p">[],</span> <span class="n">Q0</span><span class="o">=</span><span class="p">[],</span>
                             <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                             <span class="n">materials_path</span><span class="o">=</span><span class="n">materials_path</span><span class="p">)</span>

        <span class="c1"># Initializes plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="o">=</span> <span class="n">draw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span> <span class="o">=</span> <span class="n">draw_scale</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;my_cmap_r&#39;</span>
            <span class="n">reverse</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">k</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_segmentdata</span><span class="p">:</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">channel</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_segmentdata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">reverse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
            <span class="n">linear</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">reverse</span><span class="p">))</span>
            <span class="n">my_cmap_r</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">linear</span><span class="p">)</span>
            <span class="n">cmap_r</span> <span class="o">=</span> <span class="n">my_cmap_r</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_r</span><span class="p">,</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                                 <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_r</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                 <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span>
                                                   <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">state</span><span class="p">),</span>
                                                         <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">])</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                    <span class="n">cbar_stat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="p">,</span>
                                                              <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="p">,</span>
                                                              <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="n">cbar_stat</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
                                            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                                 <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                                 <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
                    <span class="n">value_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
                    <span class="n">value_2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span> <span class="n">value_2</span><span class="p">)</span>
                    <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                    <span class="n">value_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span>
                    <span class="n">value_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span>
                    <span class="n">cbar_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span>
                                                               <span class="n">ax</span><span class="o">=</span><span class="n">value_2</span><span class="p">,</span>
                                                               <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="n">cbar_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                 <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="p">,</span>
                                                     <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q (W/m²)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                                   <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                                   <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                   <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                                   <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
                    <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="p">,</span>
                                                      <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q0 (W/m²)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Object initialization.</p>

<p><code>amb_temperature</code> is the ambient temperature of the whole system.
<code>materials</code> is the background material present in <code>material_path</code>.
<code>dx</code>, <code>dy</code> are the space steps along the x- and y-axis, respectively.
<code>dt</code> is the time step. <code>file_name</code> is the file name where the
temperature is saved. <code>boundaries</code> is a list of four entries that
define the boundary condition for temperature (left, right, bottom,
top). If 0 the boundary condition is insulation. <code>initial_state</code> is the
initial state of the materials. True if there are an applied field and
False if them field is absent. <code>materials_path</code> is absolute path of the
materials database. If false, then the materials database is the
standard heatrapy database. <code>draw</code> is a list of strings representing
the online plots. In this version live plotting can be performed for
<code>temperature</code>, <code>materials</code>, <code>state</code>, <code>Q</code> and <code>Q0</code>. If the list is
empty, then no drawing is performed. <code>draw_scale</code> is a list of two
values, representing the minimum and maximum temperature to be drawn.
If None, there are no limits. <code>Q</code> is a list of fixed heat source
coefficient and <code>Q0</code> is a list of temperature dependent heat source
coefficient.</p>
</div>


                            </div>
                            <div id="SingleObject2D.show_figure" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.show_figure">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">show_figure</span><span class="signature">(self, figure_type)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">show_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plotting.</span>

<span class="sd">        Initializes a specific plotting. `figure_type` is a string identifying</span>
<span class="sd">        the plotting. In this version live plotting can be performed for</span>
<span class="sd">        `temperature`, `materials`, `state`, `Q` and `Q0`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">figure_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">figure_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span>
                                         <span class="n">vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;temperature (K)&quot;</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">state</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                                 <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                 <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># &quot;state&quot;</span>
            <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">])</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">cbar_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="p">,</span>
                                                       <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="p">,</span>
                                                       <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar_state</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_state</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;PiYG&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                         <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                         <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                         <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">materials_name_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
            <span class="n">materials_name_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">materials_name_list</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                  <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                           <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
            <span class="n">cbar_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span><span class="p">,</span>
                                                       <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="p">,</span>
                                                       <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="n">cbar_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                         <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                         <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                         <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q (W/m²)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">figure_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                           <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                                           <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                           <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                                           <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;hamming&#39;</span><span class="p">)</span>
            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q0 (W/m²)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_Q0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Plotting.</p>

<p>Initializes a specific plotting. <code>figure_type</code> is a string identifying
the plotting. In this version live plotting can be performed for
<code>temperature</code>, <code>materials</code>, <code>state</code>, <code>Q</code> and <code>Q0</code>.</p>
</div>


                            </div>
                            <div id="SingleObject2D.activate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.activate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">activate</span><span class="signature">(self, initial_point, final_point, shape=&#39;square&#39;)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activation of the material.</span>

<span class="sd">        Activates a given piece of material. If `shape` is `&#39;square&#39;`, then the</span>
<span class="sd">        `initial_point` is the tuple (x,y) of the bottom left point and the</span>
<span class="sd">        `final_point` is the tuple (x,y) of the top right point. If the shape</span>
<span class="sd">        is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the center of</span>
<span class="sd">        the circle and `final_point` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span>
                             <span class="n">final_point</span><span class="o">=</span><span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Activation of the material.</p>

<p>Activates a given piece of material. If <code>shape</code> is <code>'square'</code>, then the
<code>initial_point</code> is the tuple (x,y) of the bottom left point and the
<code>final_point</code> is the tuple (x,y) of the top right point. If the shape
is <code>'circle'</code>, the <code>initial_point</code> is the tuple (x,y) of the center of
the circle and <code>final_point</code> is its radius.</p>
</div>


                            </div>
                            <div id="SingleObject2D.deactivate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.deactivate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">deactivate</span><span class="signature">(self, initial_point, final_point, shape=&#39;square&#39;)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deactivation of the material.</span>

<span class="sd">        Deactivates a given piece of material. If `shape` is `&#39;square&#39;`, then</span>
<span class="sd">        the `initial_point` is the tuple (x,y) of the bottom left point and the</span>
<span class="sd">        `final_point` is the tuple (x,y) of the top right point. If the shape</span>
<span class="sd">        is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the center of</span>
<span class="sd">        the circle and `final_point` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">deactivate</span><span class="p">(</span><span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span>
                               <span class="n">final_point</span><span class="o">=</span><span class="n">final_point</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                        <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                        <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;state&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">im_state</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">figure_state</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Deactivation of the material.</p>

<p>Deactivates a given piece of material. If <code>shape</code> is <code>'square'</code>, then
the <code>initial_point</code> is the tuple (x,y) of the bottom left point and the
<code>final_point</code> is the tuple (x,y) of the top right point. If the shape
is <code>'circle'</code>, the <code>initial_point</code> is the tuple (x,y) of the center of
the circle and <code>final_point</code> is its radius.</p>
</div>


                            </div>
                            <div id="SingleObject2D.change_boundaries" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.change_boundaries">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_boundaries</span><span class="signature">(self, boundaries)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boundary change.</span>

<span class="sd">        Changes the `boundaries` variable.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="n">boundaries</span>
</pre></div>

        </details>

            <div class="docstring"><p>Boundary change.</p>

<p>Changes the <code>boundaries</code> variable.</p>
</div>


                            </div>
                            <div id="SingleObject2D.change_material" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.change_material">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_material</span><span class="signature">(self, shape, material, initial_point, length, state=False)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span>
                        <span class="n">state</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Material change.</span>

<span class="sd">        Changes the material of a given piece of the background material. If</span>
<span class="sd">        `shape` is `&#39;square&#39;`, then the initial_point is the tuple (x,y) of the</span>
<span class="sd">        bottom left point and the `length` is the tuple (x,y) of the length. If</span>
<span class="sd">        the shape is `&#39;circle&#39;`, the `initial_point` is the tuple (x,y) of the</span>
<span class="sd">        center of the circle and `length` is its radius.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
                               <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">materials_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span>
                               <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
                               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">materials_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">materials_path</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;materials&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_materials</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;PiYG&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
                <span class="n">material_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">material_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                             <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                                                             <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                                             <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                                             <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
                                                             <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cbarlabel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">materials_name_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_name</span><span class="p">)</span>
                <span class="n">materials_name_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">qrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">materials_name_list</span><span class="p">)</span>
                <span class="n">value_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">))</span>
                <span class="n">value_2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">value_1</span><span class="p">,</span> <span class="n">value_2</span><span class="p">)</span>
                <span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">qrates</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
                <span class="n">fmt</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                <span class="n">cba_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">im_materials</span><span class="p">,</span>
                                                          <span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="p">,</span>
                                                          <span class="o">**</span><span class="n">cbar_kw</span><span class="p">)</span>
                <span class="n">cba_m</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Materials&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x axis (m)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_materials</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y axis (m)&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Material change.</p>

<p>Changes the material of a given piece of the background material. If
<code>shape</code> is <code>'square'</code>, then the initial_point is the tuple (x,y) of the
bottom left point and the <code>length</code> is the tuple (x,y) of the length. If
the shape is <code>'circle'</code>, the <code>initial_point</code> is the tuple (x,y) of the
center of the circle and <code>length</code> is its radius.</p>
</div>


                            </div>
                            <div id="SingleObject2D.change_power" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.change_power">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">change_power</span><span class="signature">(self, shape, power_type, initial_point, final_point, power)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">change_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="p">,</span> <span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span>
                     <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Power change.</span>

<span class="sd">        Changes the power matrix of the thermal object. If `shape` is</span>
<span class="sd">        `&#39;square&#39;`, then the `initial_point` is the tuple (x,y) of the bottom</span>
<span class="sd">        left point and the `final_point` is the tuple (x,y) of the top right</span>
<span class="sd">        point. If the `shape` is `&#39;circle&#39;`, the `initial_point` is the tuple</span>
<span class="sd">        (x,y) of the center of the circle and `final_point` is its radius.</span>
<span class="sd">        `power` is the value of the power to add, and `power_type` is the type</span>
<span class="sd">        of power to be introduced, which has the value `&#39;Q&#39;` if it is</span>
<span class="sd">        temperature dependent and `&#39;Q0&#39;` if it is temperature independent.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">final_point</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial_point</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">power_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">or</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cond3</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;square&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">power_add</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span>
                                  <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="o">=</span><span class="n">power_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s1">&#39;circle&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">power_add</span><span class="p">(</span><span class="n">initial_point</span><span class="p">,</span> <span class="n">final_point</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span>
                                  <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">power_type</span><span class="o">=</span><span class="n">power_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="ow">and</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">))</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;Q0&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span> <span class="ow">and</span> <span class="n">power_type</span> <span class="o">==</span> <span class="s1">&#39;Q0&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">))</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Q0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_Q0</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">figure_Q0</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Power change.</p>

<p>Changes the power matrix of the thermal object. If <code>shape</code> is
<code>'square'</code>, then the <code>initial_point</code> is the tuple (x,y) of the bottom
left point and the <code>final_point</code> is the tuple (x,y) of the top right
point. If the <code>shape</code> is <code>'circle'</code>, the <code>initial_point</code> is the tuple
(x,y) of the center of the circle and <code>final_point</code> is its radius.
<code>power</code> is the value of the power to add, and <code>power_type</code> is the type
of power to be introduced, which has the value <code>'Q'</code> if it is
temperature dependent and <code>'Q0'</code> if it is temperature independent.</p>
</div>


                            </div>
                            <div id="SingleObject2D.compute" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#SingleObject2D.compute">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">compute</span><span class="signature">(
    self,
    time_interval,
    write_interval,
    solver=&#39;explicit_general&#39;,
    verbose=True
)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_interval</span><span class="p">,</span> <span class="n">write_interval</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;explicit_general&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the thermal process.</span>

<span class="sd">        Computes the system for `time_interval`, and writes into the</span>
<span class="sd">        `file_name` file every `write_interval` time steps. Two different</span>
<span class="sd">        solvers can be used: `&#39;explicit_general&#39;` and `&#39;explicit_k(x)&#39;`. If</span>
<span class="sd">        verbose = True, then the progress of the computation is shown.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the validity of inputs</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
        <span class="n">cond1</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">write_interval</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">all_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;explicit_general&#39;</span><span class="p">,</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">]</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">solver</span> <span class="ow">in</span> <span class="n">all_solvers</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># number of time steps for the given timeInterval</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_interval</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># number of time steps counting from the last writing process</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># computes</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>

            <span class="c1"># updates the time_passed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">dt</span>

            <span class="c1"># defines the material properties accoring to the state list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rhoa</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">cpa</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">ka</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials_index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">Cp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">cp0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">k0</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="c1"># SOLVERS</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_general&#39;</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_general</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># explicit k constant</span>
            <span class="k">if</span> <span class="n">solver</span> <span class="o">==</span> <span class="s1">&#39;explicit_k(x)&#39;</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">explicit_k</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">lheat</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">nw</span> <span class="o">=</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_passed</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                            <span class="n">new_line</span> <span class="o">=</span> <span class="s1">&#39;,</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">new_line</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">drawing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">drawing</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nw</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">write_interval</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="n">nt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                                    <span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_scale</span><span class="p">:</span>
                                    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">max</span><span class="p">))</span>
                                    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">min</span><span class="p">))</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">nw</span> <span class="o">==</span> <span class="n">write_interval</span><span class="p">:</span>
                <span class="n">nw</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pogress:&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="n">nt</span><span class="p">),</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Finished simulation&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Compute the thermal process.</p>

<p>Computes the system for <code>time_interval</code>, and writes into the
<code>file_name</code> file every <code>write_interval</code> time steps. Two different
solvers can be used: <code>'explicit_general'</code> and <code>'explicit_k(x)'</code>. If
verbose = True, then the progress of the computation is shown.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>
